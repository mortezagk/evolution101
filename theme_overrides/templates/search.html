{% extends 'page.html' %}

{% set default_domain = 'evolution101.ir' %}
{% set site_domain = default_domain %}
{% if SITEURL %}
  {% set candidate = SITEURL|replace('https://', '')|replace('http://', '') %}
  {% if candidate.startswith('//') %}
    {% set candidate = candidate[2:] %}
  {% endif %}
  {% if candidate.endswith('/') %}
    {% set candidate = candidate[:-1] %}
  {% endif %}
  {% if candidate and not candidate.startswith('.') %}
    {% set site_domain = candidate %}
  {% endif %}
{% endif %}

{% block content %}
<h1 class="page-title">{{ page.title }}</h1>
<p>عبارت موردنظر را بنویسید؛ نتایج در گوگل و محدود به سایت «{{ site_domain }}» نمایش داده می‌شود.</p>
<div class="search-wrapper">
  <form id="site-search-form" class="form-inline" role="search" action="https://www.google.com/search" method="get">
    <div class="input-append">
      <input type="search" name="q" id="site-search-input" placeholder="چه را می‌خواهید پیدا کنید؟" required>
      <button type="submit" class="btn btn-primary">جستجو</button>
    </div>
  </form>
</div>
{% if page.content %}
<div class="page-content">{{ page.content }}</div>
{% endif %}

<script>
document.addEventListener('DOMContentLoaded', function () {
  var form = document.getElementById('site-search-form');
  var input = document.getElementById('site-search-input');
  form.addEventListener('submit', function (event) {
    var term = (input.value || '').trim();
    if (!term) {
      event.preventDefault();
      input.focus();
      return;
    }
    input.value = 'site:{{ site_domain }} ' + term;
  });
});
</script>
{% endblock content %}
